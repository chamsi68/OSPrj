#----------------------------------------------------------#
#                                                          #
#	 VGa functions. change video mode etc.                 #
#                                                          #
#----------------------------------------------------------#
	.data

	#-------------------#
	#   VGa palettes	#
	#-------------------#

palette16:
	.byte	   0,    0,    0,    0,    0, 0x2a,    0, 0x2a,    0,    0, 0x2a, 0x2a, 0x2a
	.byte	   0,    0, 0x2a,    0, 0x2a, 0x2a, 0x15,    0, 0x2a, 0x2a, 0x2a, 0x15, 0x15
	.byte	0x15, 0x15, 0x15, 0x3f, 0x15, 0x3f, 0x15, 0x15, 0x3f, 0x3f, 0x3f, 0x15, 0x15
	.byte	0x3f, 0x15, 0x3f, 0x3f, 0x3f, 0x15, 0x3f, 0x3f, 0x3f

font_8x16:
	.byte	   0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0
	.byte	   0,    0,    0,    0,    0, 0x7e, 0x81, 0xa5, 0x81, 0x81, 0xbd, 0x99, 0x81
	.byte	0x81, 0x7e,    0,    0,    0,    0,    0,    0, 0x7e, 0xff, 0xdb, 0xff, 0xff
	.byte	0xc3, 0xe7, 0xff, 0xff, 0x7e,    0,    0,    0,    0,    0,    0,    0,    0
	.byte	0x6c, 0xfe, 0xfe, 0xfe, 0xfe, 0x7c, 0x38, 0x10,    0,    0,    0,    0,    0
	.byte	   0,    0,    0, 0x10, 0x38, 0x7c, 0xfe, 0x7c, 0x38, 0x10,    0,    0,    0
	.byte	   0,    0,    0,    0,    0, 0x18, 0x3c, 0x3c, 0xe7, 0xe7, 0xe7, 0x99, 0x18
	.byte	0x3c,    0,    0,    0,    0,    0,    0,    0, 0x18, 0x3c, 0x7e, 0xff, 0xff
	.byte	0x7e, 0x18, 0x18, 0x3c,    0,    0,    0,    0,    0,    0,    0,    0,    0
	.byte	   0, 0x18, 0x3c, 0x3c, 0x18,    0,    0,    0,    0,    0,    0, 0xff, 0xff
	.byte	0xff, 0xff, 0xff, 0xff, 0xe7, 0xc3, 0xc3, 0xe7, 0xff, 0xff, 0xff, 0xff, 0xff
	.byte	0xff,    0,    0,    0,    0,    0, 0x3c, 0x66, 0x42, 0x42, 0x66, 0x3c,    0
	.byte	   0,    0,    0,    0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xc3, 0x99, 0xbd, 0xbd
	.byte	0x99, 0xc3, 0xff, 0xff, 0xff, 0xff, 0xff,    0,    0, 0x1e,  0xe, 0x1a, 0x32
	.byte	0x78, 0xcc, 0xcc, 0xcc, 0xcc, 0x78,    0,    0,    0,    0,    0,    0, 0x3c
	.byte	0x66, 0x66, 0x66, 0x66, 0x3c, 0x18, 0x7e, 0x18, 0x18,    0,    0,    0,    0
	.byte	   0,    0, 0x3f, 0x33, 0x3f, 0x30, 0x30, 0x30, 0x30, 0x70, 0xf0, 0xe0,    0
	.byte	   0,    0,    0,    0,    0, 0x7f, 0x63, 0x7f, 0x63, 0x63, 0x63, 0x63, 0x67
	.byte	0xe7, 0xe6, 0xc0,    0,    0,    0,    0,    0,    0, 0x18, 0x18, 0xdb, 0x3c
	.byte	0xe7, 0x3c, 0xdb, 0x18, 0x18,    0,    0,    0,    0,    0, 0x80, 0xc0, 0xe0
	.byte	0xf0, 0xf8, 0xfe, 0xf8, 0xf0, 0xe0, 0xc0, 0x80,    0,    0,    0,    0,    0
	.byte	 0x2,  0x6,  0xe, 0x1e, 0x3e, 0xfe, 0x3e, 0x1e,  0xe,  0x6,  0x2,    0,    0
	.byte	   0,    0,    0,    0, 0x18, 0x3c, 0x7e, 0x18, 0x18, 0x18, 0x18, 0x7e, 0x3c
	.byte	0x18,    0,    0,    0,    0,    0,    0, 0x66, 0x66, 0x66, 0x66, 0x66, 0x66
	.byte	0x66,    0, 0x66, 0x66,    0,    0,    0,    0,    0,    0, 0x7f, 0xdb, 0xdb
	.byte	0xdb, 0x7b, 0x1b, 0x1b, 0x1b, 0x1b, 0x1b,    0,    0,    0,    0,    0, 0x7c
	.byte	0xc6, 0x60, 0x38, 0x6c, 0xc6, 0xc6, 0x6c, 0x38,  0xc, 0xc6, 0x7c,    0,    0
	.byte	   0,    0,    0,    0,    0,    0,    0,    0,    0, 0xfe, 0xfe, 0xfe, 0xfe
	.byte	   0,    0,    0,    0,    0,    0, 0x18, 0x3c, 0x7e, 0x18, 0x18, 0x18, 0x18
	.byte	0x7e, 0x3c, 0x18, 0x7e,    0,    0,    0,    0,    0, 0x18, 0x3c, 0x7e, 0x18
	.byte	0x18, 0x18, 0x18, 0x18, 0x18, 0x18,    0,    0,    0,    0,    0,    0, 0x18
	.byte	0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x7e, 0x3c, 0x18,    0,    0,    0,    0
	.byte	   0,    0,    0,    0,    0, 0x18,  0xc, 0xfe,  0xc, 0x18,    0,    0,    0
	.byte	   0,    0,    0,    0,    0,    0,    0,    0, 0x30, 0x60, 0xfe, 0x60, 0x30
	.byte	   0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0, 0xc0, 0xc0
	.byte	0xc0, 0xc0, 0xfe,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0
	.byte	   0, 0x28, 0x6c, 0xfe, 0x6c, 0x28,    0,    0,    0,    0,    0,    0,    0
	.byte	   0,    0,    0, 0x10, 0x38, 0x38, 0x7c, 0x7c, 0xfe, 0xfe,    0,    0,    0
	.byte	   0,    0,    0,    0,    0,    0, 0xfe, 0xfe, 0x7c, 0x7c, 0x38, 0x38, 0x10
	.byte	   0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0
	.byte	   0,    0,    0,    0,    0,    0,    0,    0,    0,    0, 0x18, 0x3c, 0x3c
	.byte	0x3c, 0x18, 0x18, 0x18,    0, 0x18, 0x18,    0,    0,    0,    0,    0, 0x66
	.byte	0x66, 0x66, 0x24,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0
	.byte	   0,    0,    0,    0, 0x6c, 0x6c, 0xfe, 0x6c, 0x6c, 0x6c, 0xfe, 0x6c, 0x6c
	.byte	   0,    0,    0,    0, 0x18, 0x18, 0x7c, 0xc6, 0xc2, 0xc0, 0x7c,  0x6, 0x86
	.byte	0xc6, 0x7c, 0x18, 0x18,    0,    0,    0,    0,    0,    0,    0, 0xc2, 0xc6
	.byte	 0xc, 0x18, 0x30, 0x60, 0xc6, 0x86,    0,    0,    0,    0,    0,    0, 0x38
	.byte	0x6c, 0x6c, 0x38, 0x76, 0xdc, 0xcc, 0xcc, 0xcc, 0x76,    0,    0,    0,    0
	.byte	   0, 0x30, 0x30, 0x30, 0x60,    0,    0,    0,    0,    0,    0,    0,    0
	.byte	   0,    0,    0,    0,    0,  0xc, 0x18, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30
	.byte	0x18,  0xc,    0,    0,    0,    0,    0,    0, 0x30, 0x18,  0xc,  0xc,  0xc
	.byte	 0xc,  0xc,  0xc, 0x18, 0x30,    0,    0,    0,    0,    0,    0,    0,    0
	.byte	   0, 0x66, 0x3c, 0xff, 0x3c, 0x66,    0,    0,    0,    0,    0,    0,    0
	.byte	   0,    0,    0,    0, 0x18, 0x18, 0x7e, 0x18, 0x18,    0,    0,    0,    0
	.byte	   0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0, 0x18, 0x18
	.byte	0x18, 0x30,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0, 0xfe
	.byte	   0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0
	.byte	   0,    0,    0,    0,    0, 0x18, 0x18,    0,    0,    0,    0,    0,    0
	.byte	   0,    0,  0x2,  0x6,  0xc, 0x18, 0x30, 0x60, 0xc0, 0x80,    0,    0,    0
	.byte	   0,    0,    0, 0x7c, 0xc6, 0xc6, 0xce, 0xd6, 0xd6, 0xe6, 0xc6, 0xc6, 0x7c
	.byte	   0,    0,    0,    0,    0,    0, 0x18, 0x38, 0x78, 0x18, 0x18, 0x18, 0x18
	.byte	0x18, 0x18, 0x7e,    0,    0,    0,    0,    0,    0, 0x7c, 0xc6,  0x6,  0xc
	.byte	0x18, 0x30, 0x60, 0xc0, 0xc6, 0xfe,    0,    0,    0,    0,    0,    0, 0x7c
	.byte	0xc6,  0x6,  0x6, 0x3c,  0x6,  0x6,  0x6, 0xc6, 0x7c,    0,    0,    0,    0
	.byte	   0,    0,  0xc, 0x1c, 0x3c, 0x6c, 0xcc, 0xfe,  0xc,  0xc,  0xc, 0x1e,    0
	.byte	   0,    0,    0,    0,    0, 0xfe, 0xc0, 0xc0, 0xc0, 0xfc,  0xe,  0x6,  0x6
	.byte	0xc6, 0x7c,    0,    0,    0,    0,    0,    0, 0x38, 0x60, 0xc0, 0xc0, 0xfc
	.byte	0xc6, 0xc6, 0xc6, 0xc6, 0x7c,    0,    0,    0,    0,    0,    0, 0xfe, 0xc6
	.byte	 0x6,  0x6,  0xc, 0x18, 0x30, 0x30, 0x30, 0x30,    0,    0,    0,    0,    0
	.byte	   0, 0x7c, 0xc6, 0xc6, 0xc6, 0x7c, 0xc6, 0xc6, 0xc6, 0xc6, 0x7c,    0,    0
	.byte	   0,    0,    0,    0, 0x7c, 0xc6, 0xc6, 0xc6, 0x7e,  0x6,  0x6,  0x6,  0xc
	.byte	0x78,    0,    0,    0,    0,    0,    0,    0,    0, 0x18, 0x18,    0,    0
	.byte	   0, 0x18, 0x18,    0,    0,    0,    0,    0,    0,    0,    0,    0, 0x18
	.byte	0x18,    0,    0,    0, 0x18, 0x18, 0x30,    0,    0,    0,    0,    0,    0
	.byte	   0,  0x6,  0xc, 0x18, 0x30, 0x60, 0x30, 0x18,  0xc,  0x6,    0,    0,    0
	.byte	   0,    0,    0,    0,    0,    0,    0, 0xfe,    0,    0, 0xfe,    0,    0
	.byte	   0,    0,    0,    0,    0,    0,    0, 0x60, 0x30, 0x18,  0xc,  0x6,  0xc
	.byte	0x18, 0x30, 0x60,    0,    0,    0,    0,    0,    0, 0x7c, 0xc6, 0xc6,  0xc
	.byte	0x18, 0x18, 0x18,    0, 0x18, 0x18,    0,    0,    0,    0,    0,    0,    0
	.byte	0x7c, 0xc6, 0xc6, 0xde, 0xde, 0xde, 0xdc, 0xc0, 0x7c,    0,    0,    0,    0
	.byte	   0,    0, 0x10, 0x38, 0x6c, 0xc6, 0xc6, 0xfe, 0xc6, 0xc6, 0xc6, 0xc6,    0
	.byte	   0,    0,    0,    0,    0, 0xfc, 0x66, 0x66, 0x66, 0x7c, 0x66, 0x66, 0x66
	.byte	0x66, 0xfc,    0,    0,    0,    0,    0,    0, 0x3c, 0x66, 0xc2, 0xc0, 0xc0
	.byte	0xc0, 0xc0, 0xc2, 0x66, 0x3c,    0,    0,    0,    0,    0,    0, 0xf8, 0x6c
	.byte	0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x6c, 0xf8,    0,    0,    0,    0,    0
	.byte	   0, 0xfe, 0x66, 0x62, 0x68, 0x78, 0x68, 0x60, 0x62, 0x66, 0xfe,    0,    0
	.byte	   0,    0,    0,    0, 0xfe, 0x66, 0x62, 0x68, 0x78, 0x68, 0x60, 0x60, 0x60
	.byte	0xf0,    0,    0,    0,    0,    0,    0, 0x3c, 0x66, 0xc2, 0xc0, 0xc0, 0xde
	.byte	0xc6, 0xc6, 0x66, 0x3a,    0,    0,    0,    0,    0,    0, 0xc6, 0xc6, 0xc6
	.byte	0xc6, 0xfe, 0xc6, 0xc6, 0xc6, 0xc6, 0xc6,    0,    0,    0,    0,    0,    0
	.byte	0x3c, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x3c,    0,    0,    0
	.byte	   0,    0,    0, 0x1e,  0xc,  0xc,  0xc,  0xc,  0xc, 0xcc, 0xcc, 0xcc, 0x78
	.byte	   0,    0,    0,    0,    0,    0, 0xe6, 0x66, 0x6c, 0x6c, 0x78, 0x78, 0x6c
	.byte	0x66, 0x66, 0xe6,    0,    0,    0,    0,    0,    0, 0xf0, 0x60, 0x60, 0x60
	.byte	0x60, 0x60, 0x60, 0x62, 0x66, 0xfe,    0,    0,    0,    0,    0,    0, 0xc6
	.byte	0xee, 0xfe, 0xfe, 0xd6, 0xc6, 0xc6, 0xc6, 0xc6, 0xc6,    0,    0,    0,    0
	.byte	   0,    0, 0xc6, 0xe6, 0xf6, 0xfe, 0xde, 0xce, 0xc6, 0xc6, 0xc6, 0xc6,    0
	.byte	   0,    0,    0,    0,    0, 0x38, 0x6c, 0xc6, 0xc6, 0xc6, 0xc6, 0xc6, 0xc6
	.byte	0x6c, 0x38,    0,    0,    0,    0,    0,    0, 0xfc, 0x66, 0x66, 0x66, 0x7c
	.byte	0x60, 0x60, 0x60, 0x60, 0xf0,    0,    0,    0,    0,    0,    0, 0x7c, 0xc6
	.byte	0xc6, 0xc6, 0xc6, 0xc6, 0xc6, 0xd6, 0xde, 0x7c,  0xc,  0xe,    0,    0,    0
	.byte	   0, 0xfc, 0x66, 0x66, 0x66, 0x7c, 0x6c, 0x66, 0x66, 0x66, 0xe6,    0,    0
	.byte	   0,    0,    0,    0, 0x7c, 0xc6, 0xc6, 0x60, 0x38,  0xc,  0x6, 0xc6, 0xc6
	.byte	0x7c,    0,    0,    0,    0,    0,    0, 0x7e, 0x7e, 0x5a, 0x18, 0x18, 0x18
	.byte	0x18, 0x18, 0x18, 0x3c,    0,    0,    0,    0,    0,    0, 0xc6, 0xc6, 0xc6
	.byte	0xc6, 0xc6, 0xc6, 0xc6, 0xc6, 0xc6, 0x7c,    0,    0,    0,    0,    0,    0
	.byte	0xc6, 0xc6, 0xc6, 0xc6, 0xc6, 0xc6, 0xc6, 0x6c, 0x38, 0x10,    0,    0,    0
	.byte	   0,    0,    0, 0xc6, 0xc6, 0xc6, 0xc6, 0xc6, 0xd6, 0xd6, 0xfe, 0x6c, 0x6c
	.byte	   0,    0,    0,    0,    0,    0, 0xc6, 0xc6, 0x6c, 0x6c, 0x38, 0x38, 0x6c
	.byte	0x6c, 0xc6, 0xc6,    0,    0,    0,    0,    0,    0, 0x66, 0x66, 0x66, 0x66
	.byte	0x3c, 0x18, 0x18, 0x18, 0x18, 0x3c,    0,    0,    0,    0,    0,    0, 0xfe
	.byte	0xc6, 0x86,  0xc, 0x18, 0x30, 0x60, 0xc2, 0xc6, 0xfe,    0,    0,    0,    0
	.byte	   0,    0, 0x3c, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x3c,    0
	.byte	   0,    0,    0,    0,    0,    0, 0x80, 0xc0, 0xe0, 0x70, 0x38, 0x1c,  0xe
	.byte	 0x6,  0x2,    0,    0,    0,    0,    0,    0, 0x3c,  0xc,  0xc,  0xc,  0xc
	.byte	 0xc,  0xc,  0xc,  0xc, 0x3c,    0,    0,    0,    0, 0x10, 0x38, 0x6c, 0xc6
	.byte	   0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0
	.byte	   0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0, 0xff
	.byte	   0,    0, 0x30, 0x30, 0x18,    0,    0,    0,    0,    0,    0,    0,    0
	.byte	   0,    0,    0,    0,    0,    0,    0,    0,    0,    0, 0x78,  0xc, 0x7c
	.byte	0xcc, 0xcc, 0xcc, 0x76,    0,    0,    0,    0,    0,    0, 0xe0, 0x60, 0x60
	.byte	0x78, 0x6c, 0x66, 0x66, 0x66, 0x66, 0xdc,    0,    0,    0,    0,    0,    0
	.byte	   0,    0,    0, 0x7c, 0xc6, 0xc0, 0xc0, 0xc0, 0xc6, 0x7c,    0,    0,    0
	.byte	   0,    0,    0, 0x1c,  0xc,  0xc, 0x3c, 0x6c, 0xcc, 0xcc, 0xcc, 0xcc, 0x76
	.byte	   0,    0,    0,    0,    0,    0,    0,    0,    0, 0x7c, 0xc6, 0xfe, 0xc0
	.byte	0xc0, 0xc6, 0x7c,    0,    0,    0,    0,    0,    0, 0x38, 0x6c, 0x64, 0x60
	.byte	0xf0, 0x60, 0x60, 0x60, 0x60, 0xf0,    0,    0,    0,    0,    0,    0,    0
	.byte	   0,    0, 0x76, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0x7c,  0xc, 0xcc, 0x78,    0
	.byte	   0,    0, 0xe0, 0x60, 0x60, 0x6c, 0x76, 0x66, 0x66, 0x66, 0x66, 0xe6,    0
	.byte	   0,    0,    0,    0,    0, 0x18, 0x18,    0, 0x38, 0x18, 0x18, 0x18, 0x18
	.byte	0x18, 0x3c,    0,    0,    0,    0,    0,    0,  0x6,  0x6,    0,  0xe,  0x6
	.byte	 0x6,  0x6,  0x6,  0x6,  0x6, 0x66, 0x66, 0x3c,    0,    0,    0, 0xe0, 0x60
	.byte	0x60, 0x66, 0x6c, 0x78, 0x78, 0x6c, 0x66, 0xe6,    0,    0,    0,    0,    0
	.byte	   0, 0x38, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x3c,    0,    0
	.byte	   0,    0,    0,    0,    0,    0,    0, 0xec, 0xfe, 0xd6, 0xd6, 0xd6, 0xd6
	.byte	0xd6,    0,    0,    0,    0,    0,    0,    0,    0,    0, 0xdc, 0x66, 0x66
	.byte	0x66, 0x66, 0x66, 0x66,    0,    0,    0,    0,    0,    0,    0,    0,    0
	.byte	0x7c, 0xc6, 0xc6, 0xc6, 0xc6, 0xc6, 0x7c,    0,    0,    0,    0,    0,    0
	.byte	   0,    0,    0, 0xdc, 0x66, 0x66, 0x66, 0x66, 0x66, 0x7c, 0x60, 0x60, 0xf0
	.byte	   0,    0,    0,    0,    0,    0, 0x76, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0x7c
	.byte	 0xc,  0xc, 0x1e,    0,    0,    0,    0,    0,    0, 0xdc, 0x76, 0x62, 0x60
	.byte	0x60, 0x60, 0xf0,    0,    0,    0,    0,    0,    0,    0,    0,    0, 0x7c
	.byte	0xc6, 0x60, 0x38,  0xc, 0xc6, 0x7c,    0,    0,    0,    0,    0,    0, 0x10
	.byte	0x30, 0x30, 0xfc, 0x30, 0x30, 0x30, 0x30, 0x36, 0x1c,    0,    0,    0,    0
	.byte	   0,    0,    0,    0,    0, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0x76,    0
	.byte	   0,    0,    0,    0,    0,    0,    0,    0, 0x66, 0x66, 0x66, 0x66, 0x66
	.byte	0x3c, 0x18,    0,    0,    0,    0,    0,    0,    0,    0,    0, 0xc6, 0xc6
	.byte	0xc6, 0xd6, 0xd6, 0xfe, 0x6c,    0,    0,    0,    0,    0,    0,    0,    0
	.byte	   0, 0xc6, 0x6c, 0x38, 0x38, 0x38, 0x6c, 0xc6,    0,    0,    0,    0,    0
	.byte	   0,    0,    0,    0, 0xc6, 0xc6, 0xc6, 0xc6, 0xc6, 0xc6, 0x7e,  0x6,  0xc
	.byte	0xf8,    0,    0,    0,    0,    0,    0, 0xfe, 0xcc, 0x18, 0x30, 0x60, 0xc6
	.byte	0xfe,    0,    0,    0,    0,    0,    0,  0xe, 0x18, 0x18, 0x18, 0x70, 0x18
	.byte	0x18, 0x18, 0x18,  0xe,    0,    0,    0,    0,    0,    0, 0x18, 0x18, 0x18
	.byte	0x18,    0, 0x18, 0x18, 0x18, 0x18, 0x18,    0,    0,    0,    0,    0,    0
	.byte	0x70, 0x18, 0x18, 0x18,  0xe, 0x18, 0x18, 0x18, 0x18, 0x70,    0,    0,    0
	.byte	   0,    0,    0, 0x76, 0xdc,    0,    0,    0,    0,    0,    0,    0,    0
	.byte	   0,    0,    0,    0,    0,    0,    0,    0, 0x10, 0x38, 0x6c, 0xc6, 0xc6
	.byte	0xc6, 0xfe,    0,    0,    0,    0,    0,    0,    0, 0x3c, 0x66, 0xc2, 0xc0
	.byte	0xc0, 0xc0, 0xc2, 0x66, 0x3c,  0xc,  0x6, 0x7c,    0,    0,    0,    0, 0xcc
	.byte	0xcc,    0, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0x76,    0,    0,    0,    0
	.byte	   0,  0xc, 0x18, 0x30,    0, 0x7c, 0xc6, 0xfe, 0xc0, 0xc0, 0xc6, 0x7c,    0
	.byte	   0,    0,    0,    0, 0x10, 0x38, 0x6c,    0, 0x78,  0xc, 0x7c, 0xcc, 0xcc
	.byte	0xcc, 0x76,    0,    0,    0,    0,    0,    0, 0xcc, 0xcc,    0, 0x78,  0xc
	.byte	0x7c, 0xcc, 0xcc, 0xcc, 0x76,    0,    0,    0,    0,    0, 0x60, 0x30, 0x18
	.byte	   0, 0x78,  0xc, 0x7c, 0xcc, 0xcc, 0xcc, 0x76,    0,    0,    0,    0,    0
	.byte	0x38, 0x6c, 0x38,    0, 0x78,  0xc, 0x7c, 0xcc, 0xcc, 0xcc, 0x76,    0,    0
	.byte	   0,    0,    0,    0,    0,    0, 0x3c, 0x66, 0x60, 0x60, 0x66, 0x3c,  0xc
	.byte	 0x6, 0x3c,    0,    0,    0,    0, 0x10, 0x38, 0x6c,    0, 0x7c, 0xc6, 0xfe
	.byte	0xc0, 0xc0, 0xc6, 0x7c,    0,    0,    0,    0,    0,    0, 0xc6, 0xc6,    0
	.byte	0x7c, 0xc6, 0xfe, 0xc0, 0xc0, 0xc6, 0x7c,    0,    0,    0,    0,    0, 0x60
	.byte	0x30, 0x18,    0, 0x7c, 0xc6, 0xfe, 0xc0, 0xc0, 0xc6, 0x7c,    0,    0,    0
	.byte	   0,    0,    0, 0x66, 0x66,    0, 0x38, 0x18, 0x18, 0x18, 0x18, 0x18, 0x3c
	.byte	   0,    0,    0,    0,    0, 0x18, 0x3c, 0x66,    0, 0x38, 0x18, 0x18, 0x18
	.byte	0x18, 0x18, 0x3c,    0,    0,    0,    0,    0, 0x60, 0x30, 0x18,    0, 0x38
	.byte	0x18, 0x18, 0x18, 0x18, 0x18, 0x3c,    0,    0,    0,    0,    0, 0xc6, 0xc6
	.byte	0x10, 0x38, 0x6c, 0xc6, 0xc6, 0xfe, 0xc6, 0xc6, 0xc6,    0,    0,    0,    0
	.byte	0x38, 0x6c, 0x38,    0, 0x38, 0x6c, 0xc6, 0xc6, 0xfe, 0xc6, 0xc6, 0xc6,    0
	.byte	   0,    0,    0, 0x18, 0x30, 0x60,    0, 0xfe, 0x66, 0x60, 0x7c, 0x60, 0x60
	.byte	0x66, 0xfe,    0,    0,    0,    0,    0,    0,    0,    0,    0, 0xcc, 0x76
	.byte	0x36, 0x7e, 0xd8, 0xd8, 0x6e,    0,    0,    0,    0,    0,    0, 0x3e, 0x6c
	.byte	0xcc, 0xcc, 0xfe, 0xcc, 0xcc, 0xcc, 0xcc, 0xce,    0,    0,    0,    0,    0
	.byte	0x10, 0x38, 0x6c,    0, 0x7c, 0xc6, 0xc6, 0xc6, 0xc6, 0xc6, 0x7c,    0,    0
	.byte	   0,    0,    0,    0, 0xc6, 0xc6,    0, 0x7c, 0xc6, 0xc6, 0xc6, 0xc6, 0xc6
	.byte	0x7c,    0,    0,    0,    0,    0, 0x60, 0x30, 0x18,    0, 0x7c, 0xc6, 0xc6
	.byte	0xc6, 0xc6, 0xc6, 0x7c,    0,    0,    0,    0,    0, 0x30, 0x78, 0xcc,    0
	.byte	0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0x76,    0,    0,    0,    0,    0, 0x60
	.byte	0x30, 0x18,    0, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0x76,    0,    0,    0
	.byte	   0,    0,    0, 0xc6, 0xc6,    0, 0xc6, 0xc6, 0xc6, 0xc6, 0xc6, 0xc6, 0x7e
	.byte	 0x6,  0xc, 0x78,    0,    0, 0xc6, 0xc6,    0, 0x38, 0x6c, 0xc6, 0xc6, 0xc6
	.byte	0xc6, 0x6c, 0x38,    0,    0,    0,    0,    0, 0xc6, 0xc6,    0, 0xc6, 0xc6
	.byte	0xc6, 0xc6, 0xc6, 0xc6, 0xc6, 0x7c,    0,    0,    0,    0,    0, 0x18, 0x18
	.byte	0x3c, 0x66, 0x60, 0x60, 0x60, 0x66, 0x3c, 0x18, 0x18,    0,    0,    0,    0
	.byte	   0, 0x38, 0x6c, 0x64, 0x60, 0xf0, 0x60, 0x60, 0x60, 0x60, 0xe6, 0xfc,    0
	.byte	   0,    0,    0,    0,    0, 0x66, 0x66, 0x3c, 0x18, 0x7e, 0x18, 0x7e, 0x18
	.byte	0x18, 0x18,    0,    0,    0,    0,    0, 0xf8, 0xcc, 0xcc, 0xf8, 0xc4, 0xcc
	.byte	0xde, 0xcc, 0xcc, 0xcc, 0xc6,    0,    0,    0,    0,    0,  0xe, 0x1b, 0x18
	.byte	0x18, 0x18, 0x7e, 0x18, 0x18, 0x18, 0x18, 0x18, 0xd8, 0x70,    0,    0,    0
	.byte	0x18, 0x30, 0x60,    0, 0x78,  0xc, 0x7c, 0xcc, 0xcc, 0xcc, 0x76,    0,    0
	.byte	   0,    0,    0,  0xc, 0x18, 0x30,    0, 0x38, 0x18, 0x18, 0x18, 0x18, 0x18
	.byte	0x3c,    0,    0,    0,    0,    0, 0x18, 0x30, 0x60,    0, 0x7c, 0xc6, 0xc6
	.byte	0xc6, 0xc6, 0xc6, 0x7c,    0,    0,    0,    0,    0, 0x18, 0x30, 0x60,    0
	.byte	0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0x76,    0,    0,    0,    0,    0,    0
	.byte	0x76, 0xdc,    0, 0xdc, 0x66, 0x66, 0x66, 0x66, 0x66, 0x66,    0,    0,    0
	.byte	   0, 0x76, 0xdc,    0, 0xc6, 0xe6, 0xf6, 0xfe, 0xde, 0xce, 0xc6, 0xc6, 0xc6
	.byte	   0,    0,    0,    0,    0, 0x3c, 0x6c, 0x6c, 0x3e,    0, 0x7e,    0,    0
	.byte	   0,    0,    0,    0,    0,    0,    0,    0, 0x38, 0x6c, 0x6c, 0x38,    0
	.byte	0x7c,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0, 0x30
	.byte	0x30,    0, 0x30, 0x30, 0x60, 0xc0, 0xc6, 0xc6, 0x7c,    0,    0,    0,    0
	.byte	   0,    0,    0,    0,    0,    0, 0xfe, 0xc0, 0xc0, 0xc0, 0xc0,    0,    0
	.byte	   0,    0,    0,    0,    0,    0,    0,    0,    0, 0xfe,  0x6,  0x6,  0x6
	.byte	 0x6,    0,    0,    0,    0,    0,    0, 0xc0, 0xc0, 0xc2, 0xc6, 0xcc, 0x18
	.byte	0x30, 0x60, 0xce, 0x93,  0x6,  0xc, 0x1f,    0,    0,    0, 0xc0, 0xc0, 0xc2
	.byte	0xc6, 0xcc, 0x18, 0x30, 0x66, 0xce, 0x9a, 0x3f,  0x6,  0xf,    0,    0,    0
	.byte	   0, 0x18, 0x18,    0, 0x18, 0x18, 0x18, 0x3c, 0x3c, 0x3c, 0x18,    0,    0
	.byte	   0,    0,    0,    0,    0,    0,    0, 0x33, 0x66, 0xcc, 0x66, 0x33,    0
	.byte	   0,    0,    0,    0,    0,    0,    0,    0,    0,    0, 0xcc, 0x66, 0x33
	.byte	0x66, 0xcc,    0,    0,    0,    0,    0,    0, 0x11, 0x44, 0x11, 0x44, 0x11
	.byte	0x44, 0x11, 0x44, 0x11, 0x44, 0x11, 0x44, 0x11, 0x44, 0x11, 0x44, 0x55, 0xaa
	.byte	0x55, 0xaa, 0x55, 0xaa, 0x55, 0xaa, 0x55, 0xaa, 0x55, 0xaa, 0x55, 0xaa, 0x55
	.byte	0xaa, 0xdd, 0x77, 0xdd, 0x77, 0xdd, 0x77, 0xdd, 0x77, 0xdd, 0x77, 0xdd, 0x77
	.byte	0xdd, 0x77, 0xdd, 0x77, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18
	.byte	0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18
	.byte	0x18, 0xf8, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18
	.byte	0x18, 0x18, 0xf8, 0x18, 0xf8, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18
	.byte	0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0xf6, 0x36, 0x36, 0x36, 0x36, 0x36
	.byte	0x36, 0x36, 0x36,    0,    0,    0,    0,    0,    0,    0, 0xfe, 0x36, 0x36
	.byte	0x36, 0x36, 0x36, 0x36, 0x36, 0x36,    0,    0,    0,    0,    0, 0xf8, 0x18
	.byte	0xf8, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x36, 0x36, 0x36, 0x36
	.byte	0x36, 0xf6,  0x6, 0xf6, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36
	.byte	0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36
	.byte	0x36, 0x36,    0,    0,    0,    0,    0, 0xfe,  0x6, 0xf6, 0x36, 0x36, 0x36
	.byte	0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0xf6,  0x6, 0xfe
	.byte	   0,    0,    0,    0,    0,    0,    0,    0, 0x36, 0x36, 0x36, 0x36, 0x36
	.byte	0x36, 0x36, 0xfe,    0,    0,    0,    0,    0,    0,    0,    0, 0x18, 0x18
	.byte	0x18, 0x18, 0x18, 0xf8, 0x18, 0xf8,    0,    0,    0,    0,    0,    0,    0
	.byte	   0,    0,    0,    0,    0,    0,    0,    0, 0xf8, 0x18, 0x18, 0x18, 0x18
	.byte	0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x1f,    0
	.byte	   0,    0,    0,    0,    0,    0,    0, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18
	.byte	0x18, 0xff,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0
	.byte	   0,    0,    0,    0, 0xff, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18
	.byte	0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x1f, 0x18, 0x18, 0x18, 0x18, 0x18
	.byte	0x18, 0x18, 0x18,    0,    0,    0,    0,    0,    0,    0, 0xff,    0,    0
	.byte	   0,    0,    0,    0,    0,    0, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18
	.byte	0xff, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18
	.byte	0x18, 0x1f, 0x18, 0x1f, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x36
	.byte	0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x37, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36
	.byte	0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x37, 0x30, 0x3f,    0,    0,    0
	.byte	   0,    0,    0,    0,    0,    0,    0,    0,    0,    0, 0x3f, 0x30, 0x37
	.byte	0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36
	.byte	0xf7,    0, 0xff,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0
	.byte	   0,    0,    0, 0xff,    0, 0xf7, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36
	.byte	0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x37, 0x30, 0x37, 0x36, 0x36, 0x36, 0x36
	.byte	0x36, 0x36, 0x36, 0x36,    0,    0,    0,    0,    0, 0xff,    0, 0xff,    0
	.byte	   0,    0,    0,    0,    0,    0,    0, 0x36, 0x36, 0x36, 0x36, 0x36, 0xf7
	.byte	   0, 0xf7, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x18, 0x18, 0x18
	.byte	0x18, 0x18, 0xff,    0, 0xff,    0,    0,    0,    0,    0,    0,    0,    0
	.byte	0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0xff,    0,    0,    0,    0,    0
	.byte	   0,    0,    0,    0,    0,    0,    0,    0, 0xff,    0, 0xff, 0x18, 0x18
	.byte	0x18, 0x18, 0x18, 0x18, 0x18, 0x18,    0,    0,    0,    0,    0,    0,    0
	.byte	0xff, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36
	.byte	0x36, 0x36, 0x36, 0x3f,    0,    0,    0,    0,    0,    0,    0,    0, 0x18
	.byte	0x18, 0x18, 0x18, 0x18, 0x1f, 0x18, 0x1f,    0,    0,    0,    0,    0,    0
	.byte	   0,    0,    0,    0,    0,    0,    0, 0x1f, 0x18, 0x1f, 0x18, 0x18, 0x18
	.byte	0x18, 0x18, 0x18, 0x18, 0x18,    0,    0,    0,    0,    0,    0,    0, 0x3f
	.byte	0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36
	.byte	0x36, 0x36, 0xff, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x18, 0x18
	.byte	0x18, 0x18, 0x18, 0xff, 0x18, 0xff, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18
	.byte	0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0xf8,    0,    0,    0,    0
	.byte	   0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0, 0x1f, 0x18
	.byte	0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff
	.byte	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,    0,    0,    0
	.byte	   0,    0,    0,    0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff
	.byte	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0
	.byte	0xf0, 0xf0, 0xf0,  0xf,  0xf,  0xf,  0xf,  0xf,  0xf,  0xf,  0xf,  0xf,  0xf
	.byte	 0xf,  0xf,  0xf,  0xf,  0xf,  0xf, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff
	.byte	   0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0
	.byte	   0, 0x76, 0xdc, 0xd8, 0xd8, 0xd8, 0xdc, 0x76,    0,    0,    0,    0,    0
	.byte	   0,    0,    0,    0, 0xfc, 0xc6, 0xfc, 0xc6, 0xc6, 0xfc, 0xc0, 0xc0, 0xc0
	.byte	   0,    0,    0,    0, 0xfe, 0xc6, 0xc6, 0xc0, 0xc0, 0xc0, 0xc0, 0xc0, 0xc0
	.byte	0xc0,    0,    0,    0,    0,    0,    0,    0,    0, 0x80, 0xfe, 0x6c, 0x6c
	.byte	0x6c, 0x6c, 0x6c, 0x6c,    0,    0,    0,    0,    0,    0,    0, 0xfe, 0xc6
	.byte	0x60, 0x30, 0x18, 0x30, 0x60, 0xc6, 0xfe,    0,    0,    0,    0,    0,    0
	.byte	   0,    0,    0, 0x7e, 0xd8, 0xd8, 0xd8, 0xd8, 0xd8, 0x70,    0,    0,    0
	.byte	   0,    0,    0,    0,    0, 0x66, 0x66, 0x66, 0x66, 0x66, 0x7c, 0x60, 0x60
	.byte	0xc0,    0,    0,    0,    0,    0,    0,    0, 0x76, 0xdc, 0x18, 0x18, 0x18
	.byte	0x18, 0x18, 0x18,    0,    0,    0,    0,    0,    0,    0, 0x7e, 0x18, 0x3c
	.byte	0x66, 0x66, 0x66, 0x3c, 0x18, 0x7e,    0,    0,    0,    0,    0,    0,    0
	.byte	0x38, 0x6c, 0xc6, 0xc6, 0xfe, 0xc6, 0xc6, 0x6c, 0x38,    0,    0,    0,    0
	.byte	   0,    0, 0x38, 0x6c, 0xc6, 0xc6, 0xc6, 0x6c, 0x6c, 0x6c, 0x6c, 0xee,    0
	.byte	   0,    0,    0,    0,    0, 0x1e, 0x30, 0x18,  0xc, 0x3e, 0x66, 0x66, 0x66
	.byte	0x66, 0x3c,    0,    0,    0,    0,    0,    0,    0,    0,    0, 0x7e, 0xdb
	.byte	0xdb, 0xdb, 0x7e,    0,    0,    0,    0,    0,    0,    0,    0,    0,  0x3
	.byte	 0x6, 0x7e, 0xcf, 0xdb, 0xf3, 0x7e, 0x60, 0xc0,    0,    0,    0,    0,    0
	.byte	   0, 0x1c, 0x30, 0x60, 0x60, 0x7c, 0x60, 0x60, 0x60, 0x30, 0x1c,    0,    0
	.byte	   0,    0,    0,    0,    0, 0x7c, 0xc6, 0xc6, 0xc6, 0xc6, 0xc6, 0xc6, 0xc6
	.byte	0xc6,    0,    0,    0,    0,    0,    0,    0,    0, 0xfe,    0,    0, 0xfe
	.byte	   0,    0, 0xfe,    0,    0,    0,    0,    0,    0,    0,    0,    0, 0x18
	.byte	0x18, 0x7e, 0x18, 0x18,    0,    0, 0xff,    0,    0,    0,    0,    0,    0
	.byte	   0, 0x30, 0x18,  0xc,  0x6,  0xc, 0x18, 0x30,    0, 0x7e,    0,    0,    0
	.byte	   0,    0,    0,    0,  0xc, 0x18, 0x30, 0x60, 0x30, 0x18,  0xc,    0, 0x7e
	.byte	   0,    0,    0,    0,    0,    0,  0xe, 0x1b, 0x1b, 0x18, 0x18, 0x18, 0x18
	.byte	0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18
	.byte	0x18, 0x18, 0xd8, 0xd8, 0xd8, 0x70,    0,    0,    0,    0,    0,    0,    0
	.byte	   0, 0x18, 0x18,    0, 0x7e,    0, 0x18, 0x18,    0,    0,    0,    0,    0
	.byte	   0,    0,    0,    0,    0, 0x76, 0xdc,    0, 0x76, 0xdc,    0,    0,    0
	.byte	   0,    0,    0,    0, 0x38, 0x6c, 0x6c, 0x38,    0,    0,    0,    0,    0
	.byte	   0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0
	.byte	0x18, 0x18,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0
	.byte	   0,    0,    0,    0, 0x18,    0,    0,    0,    0,    0,    0,    0,    0
	.byte	 0xf,  0xc,  0xc,  0xc,  0xc,  0xc, 0xec, 0x6c, 0x6c, 0x3c, 0x1c,    0,    0
	.byte	   0,    0,    0, 0xd8, 0x6c, 0x6c, 0x6c, 0x6c, 0x6c,    0,    0,    0,    0
	.byte	   0,    0,    0,    0,    0,    0, 0x70, 0x98, 0x30, 0x60, 0xc8, 0xf8,    0
	.byte	   0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0, 0x7c
	.byte	0x7c, 0x7c, 0x7c, 0x7c, 0x7c, 0x7c,    0,    0,    0,    0,    0,    0,    0
	.byte	   0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0
	.byte	   0

mode0x3:
	.byte	0x67,    0,  0x3,    0,  0x3,    0,  0x2, 0x5f, 0x4f, 0x50, 0x82, 0x55, 0x81
	.byte	0xbf, 0x1f,    0, 0x4f,  0xe,  0xf,    0,    0,    0,    0, 0x9c,  0xe, 0x8f
	.byte	0x28,  0x1, 0x96, 0xb9, 0xa3, 0xff,    0,    0,    0,    0,    0, 0x10,  0xe
	.byte	   0, 0xff,    0,  0x1,  0x2,  0x3,  0x4,  0x5, 0x14,  0x7, 0x38, 0x39, 0x3a
	.byte	0x3b, 0x3c, 0x3d, 0x3e, 0x3f,  0xc,    0,  0xf,  0x8,    0

	.text
	.globl	set_mode_0x3

#---------------------------------#
#  sets the screen to mode 0x3    #
#---------------------------------#

set_mode_0x3:
	pushl	%ebp
	movl	%esp, %ebp

	pushl	$font_8x16
	call	load_font

	movl	$mode0x3, %esi
	call    set_regs

	movl	$palette16, (%esp)
	call    set_palette16
	addl	$4, %esp

	movl	$0x3, VGAMode
	movl	$0, MinX
	movl	$0, MinY
	movl	$79, MaxX
	movl	$24, MaxY

	leave
	ret

#----------------------------#
#  loads the standard font   #
#----------------------------#

load_font:
	pushl	%ebp
	movl	%esp, %ebp
	subl	$8, %esp
	movl	$0, -4(%ebp)
0:
	cmpl	$0xff, -4(%ebp)
	jg		0f
	movl	$0, -8(%ebp)
1:
	cmpl	$0xf, -8(%ebp)
	jg		1f
	movl	-4(%ebp), %edi
	sall	$5, %edi
	addl	-8(%ebp), %edi
	sall	$2, %edi
	addl	$0xa0002, %edi
	movl	-4(%ebp), %esi
	sall	$4, %esi
	addl	-8(%ebp), %esi
	addl	8(%ebp), %esi
	movsb
	incl	-8(%ebp)
	jmp		1b
1:
	incl	-4(%ebp)
	jmp		0b
0:
	leave
	ret

#---------------------------------------------#
#  sets the palette (16 colors)               #
#                                             #
# input:  1st argument = 8(ebp) = palette.    #
# output: none.                               #
#---------------------------------------------#

set_palette16:
	pushl	%ebp
	movl	%esp, %ebp

	xorw	%cx, %cx
0:
	movw	$0x3da, %dx
	inb		%dx, %al
	movb	%cl, %al					# color no.
	movw	$0x3c0, %dx
	outb	%al, %dx
	incw	%dx							# port 0x3C1
	inb		%dx, %al
	movw	$0x3c8, %dx
	outb	%al, %dx

	incw	%dx							# port 0x3C9
	movl	8(%ebp), %eax
	movb	(%eax), %al					# red
	outb	%al, %dx
	incl	8(%ebp)
	movl	8(%ebp), %eax
	movb	(%eax), %al					# green
	outb	%al, %dx
	incl	8(%ebp)
	movl	8(%ebp), %eax
	movb	(%eax), %al					# blue
	outb	%al, %dx
	incl	8(%ebp)

	incw	%cx
	cmpw	$0xf, %cx
	jle		0b

	movw	$0x3da, %dx
	inb		%dx, %al
	movb	$0x20, %al
	movw	$0x3c0, %dx
	outb	%al, %dx

	leave
	ret
